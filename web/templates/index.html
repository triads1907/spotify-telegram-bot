<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Downloader - Spotify Style</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z" />
            </svg>
            <span>Music</span>
        </div>

        <nav class="nav">
            <a href="#" class="nav-item active" data-page="search">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                </svg>
                <span>Search</span>
            </a>

            <a href="#" class="nav-item" data-page="playlists">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z" />
                </svg>
                <span>Playlists</span>
            </a>

            <a href="#" class="nav-item" data-page="history">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z" />
                </svg>
                <span>History</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="search-bar">
                <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                </svg>
                <input type="text" id="searchInput"
                    placeholder="Search for songs, artists, albums or paste Spotify link..." />
            </div>

            <div class="user-profile" id="userProfile">
                <button class="login-btn" id="loginBtn">Login with Telegram</button>
                <div class="user-info" id="userInfo" style="display: none;">
                    <span class="username" id="displayUsername"></span>
                    <div class="user-avatar" id="userAvatar">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                        </svg>
                    </div>
                </div>
            </div>
        </header>

        <!-- Search Results -->
        <div id="searchResults" class="content-section active">
            <div class="results-grid" id="resultsGrid">
                <!-- Results will be inserted here -->
            </div>

            <!-- Library Section (Discover) -->
            <div id="librarySection" class="library-section">
                <div class="section-header">
                    <h2 class="section-title">Discover</h2>
                    <button class="sync-btn" id="syncBtn" onclick="syncLibrary()"
                        title="Sync tracks from Telegram channel">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                            <path
                                d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z" />
                        </svg>
                        Sync with Telegram
                    </button>
                </div>
                <div class="results-grid" id="libraryGrid">
                    <!-- Library tracks will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Playlists -->
        <div id="playlists" class="content-section">
            <div class="section-header">
                <h2>Your Playlists</h2>
                <button class="create-pl-btn" onclick="openCreatePlaylistModal()">+ New Playlist</button>
            </div>
            <div class="playlists-grid" id="playlistsGrid">
                <!-- Playlists will be inserted here -->
            </div>
        </div>

        <!-- History -->
        <div id="history" class="content-section">
            <h2>Recently Downloaded</h2>
            <div class="history-list" id="historyList">
                <!-- History will be inserted here -->
            </div>
        </div>
    </main>

    <!-- Player Bar -->
    <div class="player-bar">
        <div class="player-track-info">
            <div class="track-image">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z" />
                </svg>
            </div>
            <div class="track-details">
                <div class="track-name">Select a track</div>
                <div class="track-artist">No track playing</div>
            </div>
        </div>

        <div class="player-center">
            <div class="player-controls">
                <button class="control-btn inactive" id="shuffleBtn" title="Shuffle">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z" />
                    </svg>
                </button>
                <button class="control-btn" id="prevBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z" />
                    </svg>
                </button>
                <button class="control-btn play-btn" id="playBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>
                <button class="control-btn" id="nextBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" />
                    </svg>
                </button>
                <button class="control-btn inactive" id="repeatBtn" title="Repeat">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z" />
                    </svg>
                </button>
            </div>
            <div class="player-progress-container">
                <span class="time-current" id="currentTime">0:00</span>
                <input type="range" class="progress-slider" id="progressSlider" min="0" max="100" value="0">
                <span class="time-total" id="totalTime">0:00</span>
            </div>
        </div>

        <div class="player-volume">
            <svg class="volume-icon" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" />
            </svg>
            <input type="range" class="volume-slider" min="0" max="100" value="70" />
        </div>
    </div>

    <!-- Download Modal -->
    <div id="downloadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Download Options</h3>
                <button class="close-btn" onclick="closeDownloadModal()">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="option-group">
                    <label>Format</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="format" value="mp3" checked />
                            <span>MP3</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="format" value="flac" />
                            <span>FLAC</span>
                        </label>
                    </div>
                </div>
                <div class="option-group">
                    <label>Quality</label>
                    <select id="qualitySelect" class="quality-select">
                        <option value="128">128 kbps</option>
                        <option value="192">192 kbps</option>
                        <option value="320" selected>320 kbps</option>
                    </select>
                </div>
                <button class="download-btn" onclick="startDownload()">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z" />
                    </svg>
                    <span>Download</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Create Playlist Modal -->
    <div id="createPlaylistModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Playlist</h3>
                <button class="close-btn" onclick="closeCreatePlaylistModal()">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="option-group">
                    <label>Name</label>
                    <input type="text" id="playlistNameInput" class="text-input" placeholder="My Awesome Playlist" />
                </div>
                <div class="option-group">
                    <label>Description (optional)</label>
                    <textarea id="playlistDescInput" class="text-input"
                        placeholder="Playlist description..."></textarea>
                </div>
                <button class="create-btn" onclick="createPlaylist()">Create</button>
            </div>
        </div>
    </div>

    <!-- Add to Playlist Modal -->
    <div id="addToPlaylistModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add to Playlist</h3>
                <button class="close-btn" onclick="closeAddToPlaylistModal()">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="playlists-selection-list" id="playlistsSelectionList">
                    <!-- Playlists to select will be here -->
                </div>
            </div>
        </div>
    </div>

    <audio id="audioPlayer" style="display: none;"></audio>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>